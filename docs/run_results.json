{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.4", "generated_at": "2024-02-15T17:04:54.676233Z", "invocation_id": "9aebbb9a-4dfe-4e5a-8574-d9283baae836", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.587902Z", "completed_at": "2024-02-15T17:04:54.598085Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.599133Z", "completed_at": "2024-02-15T17:04:54.599159Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013674736022949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments", "compiled": true, "compiled_code": "SELECT\n    *,\n    EXTRACT(date from commnet_timestamp) as date,\n    EXTRACT(day from commnet_timestamp) as day,\n    EXTRACT(month from commnet_timestamp) as month,\n    EXTRACT(year from commnet_timestamp) as year\nFROM `flexordemo`.`demo_zendesk_2024_tables`.`flexor_support_tickets`\nORDER BY commnet_timestamp desc\nLIMIT 10000", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.602509Z", "completed_at": "2024-02-15T17:04:54.613584Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.614306Z", "completed_at": "2024-02-15T17:04:54.614312Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013410091400146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_discount", "compiled": true, "compiled_code": "\n\n\n    \n\n\n\n    \n\n\n   SELECT\n        '' as flexor_id,\n        JSON '{}' as flex\n    FROM\n        `flexordemo`.`elad_example`.`tickets_comments` src\n    WHERE 1 = 0\n\n\n\n\n\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_discount`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.616561Z", "completed_at": "2024-02-15T17:04:54.619502Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.620199Z", "completed_at": "2024-02-15T17:04:54.620203Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005035877227783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_identifier", "compiled": true, "compiled_code": "\n\n\n    \n\n\n\n    \n\n\n   SELECT\n        '' as flexor_id,\n        JSON '{}' as flex\n    FROM\n        `flexordemo`.`elad_example`.`tickets_comments` src\n    WHERE 1 = 0\n\n\n\n\n\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_identifier`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.622509Z", "completed_at": "2024-02-15T17:04:54.625408Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.626065Z", "completed_at": "2024-02-15T17:04:54.626069Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004954099655151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_interface", "compiled": true, "compiled_code": "\n\n\n    \n\n\n\n    \n\n\n   SELECT\n        '' as flexor_id,\n        JSON '{}' as flex\n    FROM\n        `flexordemo`.`elad_example`.`tickets_comments` src\n    WHERE 1 = 0\n\n\n\n\n\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_interface`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.628078Z", "completed_at": "2024-02-15T17:04:54.630541Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.631178Z", "completed_at": "2024-02-15T17:04:54.631182Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004344940185546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_shipping", "compiled": true, "compiled_code": "\n\n\n    \n\n\n\n    \n\n\n   SELECT\n        '' as flexor_id,\n        JSON '{}' as flex\n    FROM\n        `flexordemo`.`elad_example`.`tickets_comments` src\n    WHERE 1 = 0\n\n\n\n\n\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_shipping`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.633212Z", "completed_at": "2024-02-15T17:04:54.635494Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.636090Z", "completed_at": "2024-02-15T17:04:54.636094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004087686538696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_specific_product", "compiled": true, "compiled_code": "\n\n\n    \n\n\n\n    \n\n\n   SELECT\n        '' as flexor_id,\n        JSON '{}' as flex\n    FROM\n        `flexordemo`.`elad_example`.`tickets_comments` src\n    WHERE 1 = 0\n\n\n\n\n\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_specific_product`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.637987Z", "completed_at": "2024-02-15T17:04:54.640961Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.641516Z", "completed_at": "2024-02-15T17:04:54.641520Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004700899124145508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_tech_issue", "compiled": true, "compiled_code": "\n\n\n    \n\n\n\n    \n\n\n   SELECT\n        '' as flexor_id,\n        JSON '{}' as flex\n    FROM\n        `flexordemo`.`elad_example`.`tickets_comments` src\n    WHERE 1 = 0\n\n\n\n\n\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_tech_issue`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.643304Z", "completed_at": "2024-02-15T17:04:54.651911Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.652473Z", "completed_at": "2024-02-15T17:04:54.652477Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01027679443359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_identifier_category_statistics", "compiled": true, "compiled_code": "\n\n\n\n\nWITH filtered_data AS (\n    SELECT\n        flex_table.flexor_id as flexor_id,\n        \n\n\n    JSON_VALUE(flex_table.flex, '$.category')\n\n\n as category\n        \n    FROM `flexordemo`.`elad_example`.`tickets_comments_identifier` as flex_table\n    \n    \n    WHERE \n\n\n    JSON_VALUE(flex, '$.category')\n\n\n is not null\n    \n),\nPredictionCounts AS (\n    SELECT\n        category,\n        COUNT(*) AS count\n        \n    FROM filtered_data\n    GROUP BY\n        category\n        \n),\nTotalCount AS (\n    SELECT\n        SUM(count) AS total_count\n    FROM PredictionCounts\n),\nRelativeCount AS (\n    SELECT\n        SUM(count) AS relative_count\n        \n    FROM PredictionCounts\n    \n)\nSELECT \n    PredictionCounts.category as category,\n    \n    PredictionCounts.count as count,\n    ROUND((PredictionCounts.count / TotalCount.total_count) * 100, 2) AS percentage,\n    ROUND((PredictionCounts.count / RelativeCount.relative_count) * 100, 2) AS relative_percentage\nFROM PredictionCounts, TotalCount\n\n, RelativeCount \n\nORDER BY\n\n    PredictionCounts.count DESC\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_identifier_category_statistics`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.654278Z", "completed_at": "2024-02-15T17:04:54.662682Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.663201Z", "completed_at": "2024-02-15T17:04:54.663204Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010026931762695312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_shipping_statistics", "compiled": true, "compiled_code": "\n\n\n\n\n\n\nWITH filtered_data AS (\n    SELECT\n        flex_table.flexor_id as flexor_id,\n        \n\n\n    IFNULL(\n        bool(flex_table.flex.answer),\n        ( (flex_table.flex.category is not null) or (flex_table.flex.extraction is not null) )\n    )\n\n\n as answer\n        \n        \n            , reference_table.year as year\n        \n            , reference_table.month as month\n        \n        \n    FROM `flexordemo`.`elad_example`.`tickets_comments_shipping` as flex_table\n    \n    JOIN `flexordemo`.`elad_example`.`tickets_comments` as reference_table\n    ON reference_table.flexor_id = flex_table.flexor_id\n    \n    \n    WHERE \n\n\n    IFNULL(\n        bool(flex.answer),\n        ( (flex.category is not null) or (flex.extraction is not null) )\n    )\n\n\n is not null\n    \n),\nPredictionCounts AS (\n    SELECT\n        answer,\n        COUNT(*) AS count\n        \n        ,year, month\n        \n    FROM filtered_data\n    GROUP BY\n        answer\n        \n        ,year, month\n        \n),\nTotalCount AS (\n    SELECT\n        SUM(count) AS total_count\n    FROM PredictionCounts\n),\nRelativeCount AS (\n    SELECT\n        SUM(count) AS relative_count\n        \n        ,year, month\n        \n    FROM PredictionCounts\n    \n    GROUP BY year, month\n    \n)\nSELECT \n    PredictionCounts.answer as answer,\n    \n    \n        PredictionCounts.year as year,\n    \n        PredictionCounts.month as month,\n    \n    \n    PredictionCounts.count as count,\n    ROUND((PredictionCounts.count / TotalCount.total_count) * 100, 2) AS percentage,\n    ROUND((PredictionCounts.count / RelativeCount.relative_count) * 100, 2) AS relative_percentage\nFROM PredictionCounts, TotalCount\n\nJOIN RelativeCount\nON\n\n    \n    PredictionCounts.year = RelativeCount.year\n\n     AND \n    PredictionCounts.month = RelativeCount.month\n\n\nORDER BY\n\nyear, month,\n\n    PredictionCounts.count DESC\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_shipping_statistics`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-02-15T17:04:54.664804Z", "completed_at": "2024-02-15T17:04:54.674224Z"}, {"name": "execute", "started_at": "2024-02-15T17:04:54.674740Z", "completed_at": "2024-02-15T17:04:54.674744Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010947227478027344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.flexor_dbt_zendesk.tickets_comments_statistics", "compiled": true, "compiled_code": "\n\n\n\n\nWITH filtered_data AS (\n    SELECT\n        \n            \n\n\n    IFNULL(\n        bool(tickets_comments_shipping_table.flex.answer),\n        ( (tickets_comments_shipping_table.flex.category is not null) or (tickets_comments_shipping_table.flex.extraction is not null) )\n    )\n\n\n as tickets_comments_shipping,\n        \n            \n\n\n    IFNULL(\n        bool(tickets_comments_interface_table.flex.answer),\n        ( (tickets_comments_interface_table.flex.category is not null) or (tickets_comments_interface_table.flex.extraction is not null) )\n    )\n\n\n as tickets_comments_interface,\n        \n            \n\n\n    IFNULL(\n        bool(tickets_comments_tech_issue_table.flex.answer),\n        ( (tickets_comments_tech_issue_table.flex.category is not null) or (tickets_comments_tech_issue_table.flex.extraction is not null) )\n    )\n\n\n as tickets_comments_tech_issue,\n        \n        tickets_comments_shipping_table.flexor_id as flexor_id\n        \n    FROM `flexordemo`.`elad_example`.`tickets_comments_shipping` as tickets_comments_shipping_table\n    \n    \n        \n    \n        \n            JOIN `flexordemo`.`elad_example`.`tickets_comments_interface` as tickets_comments_interface_table\n            ON tickets_comments_interface_table.flexor_id = tickets_comments_shipping_table.flexor_id\n        \n    \n        \n            JOIN `flexordemo`.`elad_example`.`tickets_comments_tech_issue` as tickets_comments_tech_issue_table\n            ON tickets_comments_tech_issue_table.flexor_id = tickets_comments_shipping_table.flexor_id\n        \n    \n),\nPredictionCounts AS (\n    SELECT\n        \n            tickets_comments_shipping,\n        \n            tickets_comments_interface,\n        \n            tickets_comments_tech_issue,\n        \n        COUNT(*) AS count\n        \n    FROM filtered_data\n    GROUP BY\n        \n             tickets_comments_shipping\n        \n            ,  tickets_comments_interface\n        \n            ,  tickets_comments_tech_issue\n        \n        \n),\nTotalCount AS (\n    SELECT\n        SUM(count) AS total_count\n    FROM PredictionCounts\n),\nRelativeCount AS (\n    SELECT\n        SUM(count) AS relative_count\n        \n    FROM PredictionCounts\n    \n)\nSELECT\n    \n        PredictionCounts.tickets_comments_shipping as tickets_comments_shipping,\n    \n        PredictionCounts.tickets_comments_interface as tickets_comments_interface,\n    \n        PredictionCounts.tickets_comments_tech_issue as tickets_comments_tech_issue,\n    \n    \n    PredictionCounts.count as count,\n    ROUND((PredictionCounts.count / TotalCount.total_count) * 100, 2) AS percentage\n    \nFROM PredictionCounts, TotalCount\n\n, RelativeCount \n\nORDER BY\n\n    PredictionCounts.count DESC\n", "relation_name": "`flexordemo`.`elad_example`.`tickets_comments_statistics`"}], "elapsed_time": 0.9424309730529785, "args": {"exclude": [], "defer": false, "macro_debugging": false, "write_json": true, "printer_width": 80, "log_format": "default", "cache_selected_only": false, "which": "generate", "compile": true, "log_path": "/Users/pelegdvir/Documents/dbt-zendesk/logs", "profiles_dir": "/Users/pelegdvir/Documents/dbt-zendesk", "use_colors": true, "strict_mode": false, "log_level": "info", "static": false, "print": true, "invocation_command": "dbt docs generate", "version_check": true, "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "empty_catalog": false, "partial_parse_file_diff": true, "favor_state": false, "populate_cache": true, "send_anonymous_usage_stats": true, "introspect": true, "partial_parse": true, "log_format_file": "debug", "log_level_file": "debug", "project_dir": "/Users/pelegdvir/Documents/dbt-zendesk", "show_resource_report": false, "log_file_max_bytes": 10485760, "select": [], "quiet": false, "static_parser": true, "enable_legacy_logger": false, "use_colors_file": true}}